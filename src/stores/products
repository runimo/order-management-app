import { defineStore } from 'pinia'
import { useUserStore } from './user'
import response from '@/mocks/products.json'

export const useProductsStore = defineStore('products', {
    state: () => ({
      products: []
    }),

    actions: {
      fetchProducts () {
        this.products = response.data
      }
    },

    getters: {
      productsByCurrentUserCompany(state) {
        const userStore = useUserStore()

        if (!userStore.currentUser?.company?.id) {
          return []
        }

        return state.products.filter(product =>
          product.relationships?.supplier?.data?.id === userStore.currentUser.company.id
        )
      }
    }
})